#include<bits/stdc++.h>
using namespace std; 

char g[60][60]; 

char c5[27][5][7]= {

	{
		{".***.."},
		{"*...*."},
		{"*****."},
		{"*...*."},
		{"*...*."}
	},

	{
		{"****.."},
		{"*...*."},
		{"****.."},
		{"*...*."},
		{"****.."}
	},

	{
		{".****."},
		{"*...*."},
		{"*....."},
		{"*....."},
		{".****."}
	},

	{
		{"****.."},
		{"*...*."},
		{"*...*."},
		{"*...*."},
		{"****.."}
	},

	{
		{"*****."},
		{"*....."},
		{"***..."},
		{"*....."},
		{"*****."}
	},

	{
		{"*****."},
		{"*....."},
		{"***..."},
		{"*....."},
		{"*....."}
	},

	{
		{".****."},
		{"*....."},
		{"*..**."},
		{"*...*."},
		{".***.."}
	},

	{
		{"*...*."},
		{"*...*."},
		{"*****."},
		{"*...*."},
		{"*...*."}
	},

	{
		{"*****."},
		{"..*..."},
		{"..*..."},
		{"..*..."},
		{"*****."}
	},

	{
		{"..***."},
		{"...*.."},
		{"...*.."},
		{"*..*.."},
		{".**..."}
	},

	{
		{"*...*."},
		{"*..*.."},
		{"***..."},
		{"*..*.."},
		{"*...*."}
	},

	{
		{"*....."},
		{"*....."},
		{"*....."},
		{"*....."},
		{"*****."}
	},

	{
		{"*...*."},
		{"**.**."},
		{"*.*.*."},
		{"*...*."},
		{"*...*."}
	},

	{
		{"*...*."},
		{"**..*."},
		{"*.*.*."},
		{"*..**."},
		{"*...*."}
	},

	{
		{".***.."},
		{"*...*."},
		{"*...*."},
		{"*...*."},
		{".***.."}
	},

	{
		{"****.."},
		{"*...*."},
		{"****.."},
		{"*....."},
		{"*....."}
	},

	{
		{".***.."},
		{"*...*."},
		{"*...*."},
		{"*..**."},
		{".****."}
	},

	{
		{"****.."},
		{"*...*."},
		{"****.."},
		{"*..*.."},
		{"*...*."}
	},

	{
		{".****."},
		{"*....."},
		{".***.."},
		{"....*."},
		{"****.."}
	},

	{
		{"*****."},
		{"*.*.*."},
		{"..*..."},
		{"..*..."},
		{".***.."}
	},

	{
		{"*...*."},
		{"*...*."},
		{"*...*."},
		{"*...*."},
		{".***.."}
	},

	{
		{"*...*."},
		{"*...*."},
		{".*.*.."},
		{".*.*.."},
		{"..*..."}
	},

	{
		{"*...*."},
		{"*...*."},
		{"*.*.*."},
		{"**.**."},
		{"*...*."}
	},

	{
		{"*...*."},
		{".*.*.."},
		{"..*..."},
		{".*.*.."},
		{"*...*."}
	},

	{
		{"*...*."},
		{".*.*.."},
		{"..*..."},
		{"..*..."},
		{"..*..."}
	},

	{
		{"*****."},
		{"...*.."},
		{"..*..."},
		{".*...."},
		{"*****."}
	},

	{
		{"......"},
		{"......"},
		{"......"},
		{"......"},
		{"......"}
	}
 
};


void init(){
	for(int i=0; i<60; i++){
		for(int j=0; j<60; j++){
			g[i][j]='.';
		}
	}
}

int main(){
  init();
	char com[5], font[3], s[61];
	int row, col;
	while(scanf("%s", com)!=EOF){
		if(strcmp(com, ".EOP")==0){
			for(int i=0; i<63; i++){
				if(i==60){
					printf("\n");
					continue;		
				}
				if(i==62){
					printf("\n");
					break;
				}
				for(int j=0; j<60; j++){
					if(i==61){
						printf("-");
						continue;
					}
					printf("%c", g[i][j]);
				}
				printf("\n");
			}
      init();
    }
		if(strcmp(com, ".P")==0){
			scanf("%s %d %d |%[^|]|", font, &row, &col, &s);
			if(strcmp(font, "C1")==0){
				int len=strlen(s);
				for(int i=0; i<(len); i++){
					if(s[i]==' '){
						col++;
						continue;
					}
					g[row-1][col-1]=s[i];
					col++;
				}
			}
			else{
				int len=strlen(s);
				for(int i=0; i<(len); i++){
					for(int k=0; k<5; k++){
						if(row-1+k>=60)break;
						if(s[i]==' '){
							continue;
						}
						for(int j=0; j<6; j++){
							if(col-1+j>=60)break;
							if(c5[s[i]-'A'][k][j]=='.'){
								continue;
							}
							g[k+row-1][j+col-1]=c5[s[i]-'A'][k][j];
						}
					}
					col+=6;
					if(col-1>=60)break;
				}
			}
		}
		if(strcmp(com, ".L")==0){
			scanf("%s %d |%[^|]|", font, &row, &s);
			col=1;
			if(strcmp(font, "C1")==0){
				int len=strlen(s);
				for(int i=0; i<(len); i++){
					if(s[i]==' '){
						col++;
						continue;
					}
					g[row-1][col-1]=s[i];
					col++;
				}
			}
			else{
				int len=strlen(s);
				for(int i=0; i<(len); i++){
					for(int k=0; k<5; k++){
						if(row-1+k>=60)break;
						if(s[i]==' '){
							continue;
						}
						for(int j=0; j<6; j++){
							if(col-1+j>=60)break;
							if(c5[s[i]-'A'][k][j]=='.'){
								continue;
							}
							g[k+row-1][j+col-1]=c5[s[i]-'A'][k][j];
						}
					}
					col+=6;
					if(col-1>=60)break;
				}
			}
		}
		if(strcmp(com, ".R")==0){
			scanf("%s %d |%[^|]|", font, &row, &s);
			int len=strlen(s);
			if(strcmp(font, "C1")==0){
				col=61-len;
				if(61-len<0)col=1;
				for(int i=0; i<(len); i++){
					if(s[i]==' '){
						col++;
						continue;
					}
					g[row-1][col-1]=s[i];
					col++;
				}
			}
			else{
				col=61-len*6;
				if(61-len*6<0)col=1;
				for(int i=0; i<(len); i++){
					for(int k=0; k<5; k++){
						if(row-1+k>=60)break;
						if(s[i]==' '){
							continue;
						}
						for(int j=0; j<6; j++){
							if(col-1+j>=60)break;
							if(c5[s[i]-'A'][k][j]=='.'){
								continue;
							}
							g[k+row-1][j+col-1]=c5[s[i]-'A'][k][j];
						}
					}
					col+=6;
					if(col-1>=60)break;
				}
			}
		}
		if(strcmp(com, ".C")==0){
			scanf("%s %d |%[^|]|", font, &row, &s);
			int len=strlen(s);
			if(strcmp(font, "C1")==0){
				col=31-len/2;
				for(int i=0; i<(len); i++){
					if(s[i]==' '||col<1){
						col++;
						continue;
					}
					g[row-1][col-1]=s[i];
					col++;
				}
			}
			else{
				col=31-len*6/2;
				for(int i=0; i<(len); i++){
					for(int k=0; k<5; k++){
						if(row-1+k>=60)break;
						if(s[i]==' '){
							continue;
						}
						for(int j=0; j<6; j++){
							if(col-1+j>=60)break;
							if(c5[s[i]-'A'][k][j]=='.' || col+j<1){
								continue;
							}
							g[k+row-1][j+col-1]=c5[s[i]-'A'][k][j];
						}
					}
					col+=6;
					if(col-1>=60)break;
				}
			}
		}

	}
}
